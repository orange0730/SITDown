<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSV 標籤測試</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #1a1a1a;
            color: white;
            max-width: 1200px;
            margin: 0 auto;
        }
        h1, h2 {
            color: #4ecdc4;
        }
        .video-example {
            margin: 20px 0;
            padding: 20px;
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            display: flex;
            gap: 20px;
            align-items: start;
        }
        .video-info {
            flex: 1;
        }
        .tags-display {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 10px;
        }
        .tag {
            background: rgba(78, 205, 196, 0.2);
            border: 1px solid #4ecdc4;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.9rem;
        }
        .csv-line {
            background: rgba(0,0,0,0.5);
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-family: monospace;
            font-size: 0.9rem;
        }
        iframe {
            width: 300px;
            height: 534px;
            border-radius: 15px;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            background: rgba(0,255,0,0.2);
            border: 1px solid rgba(0,255,0,0.5);
        }
        button {
            background: #4ecdc4;
            border: none;
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
        }
        button:hover {
            background: #3cbab2;
        }
        .test-results {
            margin-top: 20px;
            padding: 20px;
            background: rgba(0,0,0,0.5);
            border-radius: 10px;
        }
    </style>
</head>
<body>
    <h1>CSV 標籤顯示測試</h1>
    
    <div class="status">
        ✅ 系統會正確地從 CSV 檔案讀取標籤並顯示在影片左側
    </div>
    
    <h2>CSV 檔案範例</h2>
    <p>以下是 CSV 檔案中的一些範例行：</p>
    
    <div class="video-example">
        <div class="video-info">
            <h3>範例 1：單一標籤</h3>
            <div class="csv-line">惡整,https://www.youtube.com/shorts/-ManL9W5yPA,</div>
            <p>解析後的標籤：</p>
            <div class="tags-display">
                <span class="tag">惡整</span>
            </div>
        </div>
    </div>
    
    <div class="video-example">
        <div class="video-info">
            <h3>範例 2：多個標籤（逗號分隔）</h3>
            <div class="csv-line">"娛樂搞笑, 遊戲",https://www.youtube.com/shorts/iWo8Mgk4of4,</div>
            <p>解析後的標籤：</p>
            <div class="tags-display">
                <span class="tag">娛樂搞笑</span>
                <span class="tag">遊戲</span>
            </div>
        </div>
    </div>
    
    <div class="video-example">
        <div class="video-info">
            <h3>範例 3：三個標籤</h3>
            <div class="csv-line">"藝術, 惡整, 娛樂搞笑",https://www.youtube.com/shorts/nvW2IVceLEY,</div>
            <p>解析後的標籤：</p>
            <div class="tags-display">
                <span class="tag">藝術</span>
                <span class="tag">惡整</span>
                <span class="tag">娛樂搞笑</span>
            </div>
        </div>
    </div>
    
    <h2>實際影片顯示範例</h2>
    <div class="video-example">
        <div style="flex: 1;">
            <h3>影片標題：創意作品</h3>
            <p>標籤會顯示在影片左側的資訊欄中：</p>
            <div class="tags-display">
                <span class="tag">藝術</span>
                <span class="tag">惡整</span>
                <span class="tag">娛樂搞笑</span>
            </div>
        </div>
        <iframe src="https://www.youtube.com/embed/nvW2IVceLEY?loop=1&playlist=nvW2IVceLEY&controls=0&modestbranding=1&rel=0&showinfo=0&iv_load_policy=3"
                frameborder="0"
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                allowfullscreen>
        </iframe>
    </div>
    
    <h2>系統處理流程</h2>
    <ol>
        <li>從 CSV 檔案讀取每一行資料</li>
        <li>使用正則表達式 <code>/[,，\/、]/</code> 分割標籤</li>
        <li>去除每個標籤的前後空白</li>
        <li>過濾掉空的標籤</li>
        <li>將標籤陣列儲存在影片物件的 <code>tags</code> 屬性中</li>
        <li>在播放影片時，透過 <code>updateVideoTags()</code> 函數顯示標籤</li>
    </ol>
    
    <div class="test-results">
        <h3>測試結果</h3>
        <button onclick="testCSVParsing()">測試 CSV 解析</button>
        <button onclick="testMainApp()">開啟主應用程式</button>
        <div id="test-output" style="margin-top: 15px; white-space: pre-wrap; font-family: monospace;"></div>
    </div>
    
    <script>
        function testCSVParsing() {
            const output = document.getElementById('test-output');
            
            // 模擬 CSV 解析過程
            const csvExamples = [
                { tags: '惡整', expected: ['惡整'] },
                { tags: '娛樂搞笑, 遊戲', expected: ['娛樂搞笑', '遊戲'] },
                { tags: '藝術, 惡整, 娛樂搞笑', expected: ['藝術', '惡整', '娛樂搞笑'] },
                { tags: '日常，娛樂搞笑', expected: ['日常', '娛樂搞笑'] },  // 全形逗號
                { tags: '音樂/舞蹈', expected: ['音樂', '舞蹈'] },  // 斜線分隔
            ];
            
            let results = '=== CSV 標籤解析測試 ===\n\n';
            
            csvExamples.forEach((example, index) => {
                // 使用實際的解析邏輯
                const tagList = example.tags.split(/[,，\/、]/)
                    .map(tag => tag.trim())
                    .filter(tag => tag.length > 0);
                
                const passed = JSON.stringify(tagList) === JSON.stringify(example.expected);
                results += `測試 ${index + 1}: ${passed ? '✅ 通過' : '❌ 失敗'}\n`;
                results += `輸入: "${example.tags}"\n`;
                results += `預期: ${JSON.stringify(example.expected)}\n`;
                results += `實際: ${JSON.stringify(tagList)}\n\n`;
            });
            
            output.textContent = results;
        }
        
        function testMainApp() {
            window.open('/', '_blank');
        }
        
        // 頁面載入時自動執行測試
        window.addEventListener('DOMContentLoaded', () => {
            console.log('CSV 標籤測試頁面已載入');
            console.log('系統會從 CSV 檔案中正確讀取並顯示標籤');
        });
    </script>
</body>
</html> 