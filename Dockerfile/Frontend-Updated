FROM nginx:alpine

# 複製前端檔案到 nginx 目錄
COPY frontend/ /usr/share/nginx/html/

# 移除不需要的檔案
RUN rm -f /usr/share/nginx/html/Dockerfile

# 修改 nginx 設定以監聽 8080 port
RUN sed -i 's/listen       80;/listen       8080;/' /etc/nginx/conf.d/default.conf

# 為單頁應用設定正確的路由
RUN echo 'location / { \
    try_files $uri $uri/ /index.html; \
}' > /etc/nginx/conf.d/spa.conf

EXPOSE 8080

CMD ["nginx", "-g", "daemon off;"] 